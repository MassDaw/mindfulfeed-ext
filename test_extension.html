<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test MindfulFeed Extension</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-btn:hover {
            background: #5a67d8;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test MindfulFeed Extension</h1>
        
        <div class="test-section">
            <h3>1. Verificar que la extensi√≥n est√° cargada</h3>
            <button class="test-btn" onclick="testExtensionLoaded()">Verificar Extensi√≥n</button>
            <div id="extension-status" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>2. Obtener configuraci√≥n</h3>
            <button class="test-btn" onclick="testGetConfig()">Obtener Config</button>
            <div id="config-result" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>3. Obtener estad√≠sticas</h3>
            <button class="test-btn" onclick="testGetStats()">Obtener Stats</button>
            <div id="stats-result" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>4. Simular sitio monitoreado</h3>
            <p>Esta p√°gina simula ser un sitio monitoreado. Deber√≠as ver logs en la consola del service worker.</p>
            <button class="test-btn" onclick="testTracking()">Test Tracking</button>
            <div id="tracking-result" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>5. Logs de la consola</h3>
            <p>Para ver los logs completos:</p>
            <ol>
                <li>Ve a <code>chrome://extensions/</code></li>
                <li>Encuentra "MindfulFeed"</li>
                <li>Haz clic en "Detalles"</li>
                <li>Haz clic en "Inspeccionar vistas: service worker"</li>
                <li>Ve a la pesta√±a "Console"</li>
            </ol>
        </div>
    </div>

    <script>
        function log(elementId, message) {
            const element = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            element.innerHTML += `[${timestamp}] ${message}\n`;
            element.scrollTop = element.scrollHeight;
        }

        function testExtensionLoaded() {
            log('extension-status', 'Verificando si la extensi√≥n est√° cargada...');
            
            if (typeof chrome !== 'undefined' && chrome.runtime && chrome.runtime.id) {
                log('extension-status', '‚úÖ Chrome runtime disponible');
                log('extension-status', `ID de extensi√≥n: ${chrome.runtime.id}`);
                
                // Intentar enviar un mensaje simple
                chrome.runtime.sendMessage({ action: 'ping' }, (response) => {
                    if (chrome.runtime.lastError) {
                        log('extension-status', `‚ùå Error: ${chrome.runtime.lastError.message}`);
                    } else {
                        log('extension-status', '‚úÖ Extensi√≥n responde correctamente');
                    }
                });
            } else {
                log('extension-status', '‚ùå Chrome runtime no disponible');
                log('extension-status', 'üí° Para probar la extensi√≥n, ve a un sitio monitoreado como youtube.com');
            }
        }

        function testGetConfig() {
            log('config-result', 'Solicitando configuraci√≥n...');
            
            chrome.runtime.sendMessage({ action: 'getConfig' }, (response) => {
                if (chrome.runtime.lastError) {
                    log('config-result', `‚ùå Error: ${chrome.runtime.lastError.message}`);
                } else {
                    log('config-result', `‚úÖ Configuraci√≥n recibida:`);
                    log('config-result', JSON.stringify(response, null, 2));
                }
            });
        }

        function testGetStats() {
            log('stats-result', 'Solicitando estad√≠sticas...');
            
            chrome.runtime.sendMessage({ action: 'getStats' }, (response) => {
                if (chrome.runtime.lastError) {
                    log('stats-result', `‚ùå Error: ${chrome.runtime.lastError.message}`);
                } else {
                    log('stats-result', `‚úÖ Estad√≠sticas recibidas:`);
                    log('stats-result', JSON.stringify(response, null, 2));
                }
            });
        }

        function testTracking() {
            log('tracking-result', 'Simulando navegaci√≥n en sitio monitoreado...');
            log('tracking-result', 'Deber√≠as ver logs en la consola del service worker');
            
            // Simular que estamos en un sitio monitoreado
            setTimeout(() => {
                log('tracking-result', '‚úÖ Test completado. Revisa la consola del service worker.');
            }, 2000);
        }

        // Auto-test al cargar la p√°gina
        window.onload = function() {
            log('extension-status', 'P√°gina cargada. Iniciando tests...');
            setTimeout(testExtensionLoaded, 1000);
        };
    </script>
</body>
</html> 